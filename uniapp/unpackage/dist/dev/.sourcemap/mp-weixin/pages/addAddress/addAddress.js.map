{"version":3,"sources":["uni-app:///main.js","webpack:///D:/VMware/koala/code/uniapp/pages/addAddress/addAddress.vue?5639","webpack:///D:/VMware/koala/code/uniapp/pages/addAddress/addAddress.vue?caca","webpack:///D:/VMware/koala/code/uniapp/pages/addAddress/addAddress.vue?ed1e","webpack:///D:/VMware/koala/code/uniapp/pages/addAddress/addAddress.vue?15a8","uni-app:///pages/addAddress/addAddress.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniForms","uniFormsItem","uniEasyinput","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","user","form","rules","address","required","errorMessage","phone","onLoad","methods","getCurrentLocation","uni","scope","success","type","longitude","latitude","url","title","icon","fail","content","saveAddress","method"],"mappings":"sJAAA,MAGA,aACA,YAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,gFCLX,6HACIC,EADJ,QAQIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,kCACZ,aAAAF,E,0CCtBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,SAAU,WACR,OAAO,wHAITC,aAAc,WACZ,OAAO,kIAITC,aAAc,WACZ,OAAO,iGAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCC3CvB,yHAA8qB,eAAG,G,sHCkHjrB,CACAC,gBACA,OACAC,iCACAC,QACAC,OACAC,SACAD,QAAAE,YAAAC,wBAEAL,MACAE,QAAAE,YAAAC,yBAEAC,OACAJ,QAAAE,YAAAC,6BAKAE,mBAAA,WACA,iBACA,KACA,8DACA,qBAGA,6BAEAC,SACAC,8BAAA,WACA,qCAGAC,aACAC,2BACAC,mBAEAF,eACAG,aACAD,oBACA,iBAAAE,cACA3B,wBAAA4B,WAAAD,cAGA,yIACA3B,gCAGAuB,WACAM,MACAJ,oBAIA,GAHAzB,8BAGA,uCACA,sCACAA,yBAGA,iBACAA,sCACA,iBACAuB,aAAAO,aAAAC,sBAEA/B,qCACAuB,aAAAO,eAAAC,gBAGAC,iBACAhC,gCACAuB,aAAAO,mBAAAC,mBAIAC,iBACAhC,6BACAuB,aAAAO,iBAAAC,mBAIAC,gBAEAT,aACAO,aACAG,6BACAR,oBACA,WACAF,uBAOAW,uBAAA,WACA,gDACA,oBACAC,8BACAN,+CACAjB,cACA,kBACA,gBACAW,aAAAO,eACAP,kBAEAA,aAAAQ,aAAAD,oBAGA,mBACA9B,2BAIA,c","file":"pages/addAddress/addAddress.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/addAddress/addAddress.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./addAddress.vue?vue&type=template&id=d114b534&\"\nvar renderjs\nimport script from \"./addAddress.vue?vue&type=script&lang=js&\"\nexport * from \"./addAddress.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/addAddress/addAddress.vue\"\nexport default component.exports","export * from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addAddress.vue?vue&type=template&id=d114b534&\"","var components\ntry {\n  components = {\n    uniForms: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-forms/components/uni-forms/uni-forms\" */ \"@/uni_modules/uni-forms/components/uni-forms/uni-forms.vue\"\n      )\n    },\n    uniFormsItem: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-forms/components/uni-forms-item/uni-forms-item\" */ \"@/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.vue\"\n      )\n    },\n    uniEasyinput: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput\" */ \"@/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addAddress.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addAddress.vue?vue&type=script&lang=js&\"","<!-- <template>\n\t<view style=\"padding: 20rpx;\">\n\t\t<view class=\"box\">\r\n\t\t\t<uni-forms :modelValue=\"form\" :rules=\"rules\" ref=\"formRef\" label-width=\"160rpx\" label-align=\"right\">\r\n\t\t\t  <uni-forms-item label=\"地址信息\" name=\"address\" required>\r\n\t\t\t    <uni-easyinput type=\"textarea\" v-model=\"form.address\" placeholder=\"请输入地址\" />\r\n\t\t\t  </uni-forms-item>\r\n\t\t\t  <uni-forms-item label=\"联系人\" name=\"user\" required>\r\n\t\t\t    <uni-easyinput type=\"text\" v-model=\"form.user\" placeholder=\"请输入联系人\" />\r\n\t\t\t  </uni-forms-item>\r\n\t\t\t  <uni-forms-item label=\"联系方式\" name=\"phone\" required>\r\n\t\t\t    <uni-easyinput type=\"text\" v-model=\"form.phone\" placeholder=\"请输入联系方式\" />\r\n\t\t\t  </uni-forms-item>\r\n\t\t\t\r\n\t\t\t  <uni-forms-item>\r\n\t\t\t    <button type=\"primary\" size=\"mini\" @click=\"saveAddress\">保 存</button>\r\n\t\t\t  </uni-forms-item>\r\n\t\t\t</uni-forms>\r\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuser: uni.getStorageSync('xm-user'),\r\n\t\t\t\tform: {},\r\n\t\t\t\trules: {\r\n\t\t\t\t  address: {\r\n\t\t\t\t    rules: [{\r\n\t\t\t\t      required: true,\r\n\t\t\t\t      errorMessage: '请填写地址',\r\n\t\t\t\t    }]\r\n\t\t\t\t  },\r\n\t\t\t\t  user: {\r\n\t\t\t\t    rules: [{\r\n\t\t\t\t      required: true,\r\n\t\t\t\t      errorMessage: '请填写联系人',\r\n\t\t\t\t    }]\r\n\t\t\t\t  },\r\n\t\t\t\t  phone: {\r\n\t\t\t\t    rules: [{\r\n\t\t\t\t      required: true,\r\n\t\t\t\t      errorMessage: '请填写联系方式',\r\n\t\t\t\t    }]\r\n\t\t\t\t  }\r\n\t\t\t\t}\n\t\t\t}\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\tlet addressId = option.addressId || 0\r\n\t\t\t\r\n\t\t\tif (addressId > 0) {\r\n\t\t\t\tthis.$request.get('/address/selectById/' + addressId).then(res => {\r\n\t\t\t\t\tthis.form = res.data || {}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\n\t\tmethods: {\n\t\t\tsaveAddress() {\r\n\t\t\t\t// 验证\r\n\t\t\t\tthis.$refs.formRef.validate().then(res => {\r\n\t\t\t\t  this.$request.request({\r\n\t\t\t\t\t  method: this.form.id ? 'PUT' : 'POST',\r\n\t\t\t\t\t  url: this.form.id ? '/address/update' : '/address/add',\r\n\t\t\t\t\t  data: this.form\r\n\t\t\t\t  }).then(res => {\r\n\t\t\t\t    if (res.code === '200') {\r\n\t\t\t\t      uni.showToast({\r\n\t\t\t\t        title: '操作成功'\r\n\t\t\t\t      })\r\n\t\t\t\t\t  uni.navigateBack()\r\n\t\t\t\t    } else {\r\n\t\t\t\t      uni.showToast({\r\n\t\t\t\t        icon: 'error',\r\n\t\t\t\t        title: res.msg\r\n\t\t\t\t      })\r\n\t\t\t\t    }\r\n\t\t\t\t  })\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t  console.log('err', err);\r\n\t\t\t\t})  \r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style -->>\n<template>\n\t<view style=\"padding: 20rpx;\">\n\t\t<view class=\"box\">\n\t\t\t<uni-forms :modelValue=\"form\" :rules=\"rules\" ref=\"formRef\" label-width=\"160rpx\" label-align=\"right\">\n\t\t\t  <uni-forms-item label=\"地址信息\" name=\"address\" required>\n\t\t\t    <uni-easyinput type=\"textarea\" v-model=\"form.address\" placeholder=\"请输入地址\" />\n\t\t\t    <button type=\"default\" size=\"mini\" @click=\"getCurrentLocation\">定位</button>\n\t\t\t  </uni-forms-item>\n\t\t\t  <uni-forms-item label=\"联系人\" name=\"user\" required>\n\t\t\t    <uni-easyinput type=\"text\" v-model=\"form.user\" placeholder=\"请输入联系人\" />\n\t\t\t  </uni-forms-item>\n\t\t\t  <uni-forms-item label=\"联系方式\" name=\"phone\" required>\n\t\t\t    <uni-easyinput type=\"text\" v-model=\"form.phone\" placeholder=\"请输入联系方式\" />\n\t\t\t  </uni-forms-item>\n\t\t\t  <uni-forms-item>\n\t\t\t    <button type=\"primary\" size=\"mini\" @click=\"saveAddress\">保 存</button>\n\t\t\t  </uni-forms-item>\n\t\t\t</uni-forms>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuser: uni.getStorageSync('xm-user'),\n\t\t\t\tform: {},\n\t\t\t\trules: {\n\t\t\t\t  address: {\n\t\t\t\t    rules: [{ required: true, errorMessage: '请填写地址' }]\n\t\t\t\t  },\n\t\t\t\t  user: {\n\t\t\t\t    rules: [{ required: true, errorMessage: '请填写联系人' }]\n\t\t\t\t  },\n\t\t\t\t  phone: {\n\t\t\t\t    rules: [{ required: true, errorMessage: '请填写联系方式' }]\n\t\t\t\t  }\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonLoad(option) {\n\t\t\tlet addressId = option.addressId || 0;\n\t\t\tif (addressId > 0) {\n\t\t\t\tthis.$request.get('/address/selectById/' + addressId).then(res => {\n\t\t\t\t\tthis.form = res.data || {}\n\t\t\t\t});\n\t\t\t}\r\n\t\t\t  this.form.address = \"address\";\n\t\t},\n\t\tmethods: {\n\tgetCurrentLocation() {\r\n\t  const ak = 'VBrEBMYmKx0XNijqhBaOOIzCcjHvR1Ag'; // 替换为你的百度地图AK\r\n\t\r\n\t  // 检查并请求用户授权\r\n\t  uni.authorize({\r\n\t    scope: 'scope.userLocation',\r\n\t    success: () => {\r\n\t      // 获取用户地理位置\r\n\t      uni.getLocation({\r\n\t        type: 'gcj02', // 获取高精度位置\r\n\t        success: (res) => {\r\n\t          const { latitude, longitude } = res; // 解构获取经纬度\r\n\t          console.log('获取的地理位置:', { latitude, longitude });\r\n\t\r\n\t          // 拼接百度地图API的请求URL\r\n\t          const url = `https://api.map.baidu.com/reverse_geocoding/v3/?ak=${ak}&output=json&coordtype=wgs84ll&location=${latitude},${longitude}`;\r\n\t          console.log('请求百度地图API的URL:', url);\r\n\t\r\n\t          // 调用百度地图API获取地址信息\r\n\t          uni.request({\r\n\t            url: url,\r\n\t            success: (response) => {\r\n\t              console.log('百度地图API响应数据:', response);\r\n\t\r\n\t              // 检查百度地图API响应是否成功\r\n\t              if (response.statusCode === 200 && response.data.status === 0) {\r\n\t                const address = response.data.result.formatted_address;\r\n\t                console.log('解析出的地址:', address);\r\n\t\r\n\t                // 更新到表单的地址字段\r\n\t                this.form.address = address;\r\n\t\t\t\t\tconsole.log('更新后的地址:', this.form.address);\r\nthis.$forceUpdate(); // 强制刷新视图\r\n\t                uni.showToast({ title: '定位成功', icon: 'success' });\r\n\t              } else {\r\n\t                console.error('百度地图API响应错误:', response.data);\r\n\t                uni.showToast({ title: '获取位置失败', icon: 'error' });\r\n\t              }\r\n\t            },\r\n\t            fail: (err) => {\r\n\t              console.error('调用百度地图API失败:', err);\r\n\t              uni.showToast({ title: '定位失败，请稍后再试', icon: 'error' });\r\n\t            }\r\n\t          });\r\n\t        },\r\n\t        fail: (err) => {\r\n\t          console.error('获取地理位置失败：', err);\r\n\t          uni.showToast({ title: '获取地理位置失败', icon: 'error' });\r\n\t        },\r\n\t      });\r\n\t    },\r\n\t    fail: () => {\r\n\t      // 用户未授权处理\r\n\t      uni.showModal({\r\n\t        title: '授权失败',\r\n\t        content: '需要获取您的位置，请前往设置打开权限',\r\n\t        success: (modalRes) => {\r\n\t          if (modalRes.confirm) {\r\n\t            uni.openSetting(); // 引导用户到设置界面\r\n\t          }\r\n\t        }\r\n\t      });\r\n\t    }\r\n\t  });\r\n\t},\n\t\t\tsaveAddress() {\n\t\t\t\tthis.$refs.formRef.validate().then(res => {\n\t\t\t\t\tthis.$request.request({\n\t\t\t\t\t\tmethod: this.form.id ? 'PUT' : 'POST',\n\t\t\t\t\t\turl: this.form.id ? '/address/update' : '/address/add',\n\t\t\t\t\t\tdata: this.form\n\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\tif (res.code === '200') {\n\t\t\t\t\t\t\tuni.showToast({ title: '操作成功' });\n\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({ icon: 'error', title: res.msg });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tconsole.log('err', err);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":""}