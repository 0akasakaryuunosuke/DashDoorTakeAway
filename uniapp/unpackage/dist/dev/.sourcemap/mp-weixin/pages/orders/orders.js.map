{"version":3,"sources":["uni-app:///main.js","webpack:///D:/VMware/koala/code/uniapp/pages/orders/orders.vue?71c4","webpack:///D:/VMware/koala/code/uniapp/pages/orders/orders.vue?d1e3","webpack:///D:/VMware/koala/code/uniapp/pages/orders/orders.vue?6d58","webpack:///D:/VMware/koala/code/uniapp/pages/orders/orders.vue?bda5","uni-app:///pages/orders/orders.vue","webpack:///D:/VMware/koala/code/uniapp/pages/orders/orders.vue?b586"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniSegmentedControl","uniIcons","uniTag","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","current","items","ordersList","user","businessQrCodeUrl","imagePopupVisible","imageUrl","onShow","methods","goComment","uni","url","goOrdersItem","del","icon","title","changeStatus","form","loadOrders","status","userId","onClickItem","loadBusinessInfo","showQrCodePopup","closeImagePopup"],"mappings":"6IAAA,MAGA,aACA,WAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,+ECLX,iIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,WACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,0BACZ,aAAAF,E,yCCvBf,sQ,gCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,oBAAqB,WACnB,OAAO,wHAITC,SAAU,WACR,OAAO,wHAITC,OAAQ,WACN,OAAO,+EAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,gCC3CvB,wHAA0qB,eAAG,G,qHCqD7qB,CACAC,gBACA,OACAC,UACAC,+BACAC,cACAC,iCACAC,qBACAC,qBACAC,cAGAC,kBACA,mBAEAC,SACAC,sBACAC,cACAC,2CAGAC,yBACAF,cACAC,iDAGAE,gBAAA,WACA,yDACA,gBACAH,aACAI,eACAC,eAEA,gBAEAL,aACAI,aACAC,kBAKAC,2BAAA,WACA,gCACAC,WACA,wDACA,gBACAP,aACAI,eACAC,eAEA,eACA,kCAEAL,aACAI,aACAC,kBAKAG,sBAAA,WACA,OACA,qBACA,OACAC,OACA,MACA,OACAA,QACA,MACA,OACAA,QACA,MACA,OACAA,QACA,MAEA,uCACAC,oBACAD,WACA,kBACA,4BAGAE,wBACA,+BACA,4BACA,oBAIAC,6BAAA,WACAnC,eACA,uEACA,gBACA,mCACAA,iCAEA,qBAEAuB,aACAI,aACAC,wBAOAQ,2BACA,qCACApC,iBACA,2BAGAqC,2BACA,6BAGA,c,4DC5KA,wHAA2+B,eAAG,G","file":"pages/orders/orders.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/orders/orders.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./orders.vue?vue&type=template&id=8a71bbb4&scoped=true&\"\nvar renderjs\nimport script from \"./orders.vue?vue&type=script&lang=js&\"\nexport * from \"./orders.vue?vue&type=script&lang=js&\"\nimport style0 from \"./orders.vue?vue&type=style&index=0&id=8a71bbb4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8a71bbb4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/orders/orders.vue\"\nexport default component.exports","export * from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orders.vue?vue&type=template&id=8a71bbb4&scoped=true&\"","var components\ntry {\n  components = {\n    uniSegmentedControl: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-segmented-control/components/uni-segmented-control/uni-segmented-control\" */ \"@/uni_modules/uni-segmented-control/components/uni-segmented-control/uni-segmented-control.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniTag: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-tag/components/uni-tag/uni-tag\" */ \"@/uni_modules/uni-tag/components/uni-tag/uni-tag.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orders.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orders.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<uni-segmented-control :current=\"current\" :values=\"items\" @clickItem=\"onClickItem\" styleType=\"text\"\n\t\t\tactiveColor=\"#ff9900\"></uni-segmented-control>\n\t\t<view style=\"padding: 20rpx;\">\n\t\t\t<view class=\"box\" v-for=\"item in ordersList\" :key=\"item.id\" style=\"margin-bottom: 10rpx;\">\n\t\t\t\t<view style=\"display: flex; align-items: baseline; margin-bottom: 10rpx;\">\n\t\t\t\t\t<navigator :url=\"'/pages/detail/detail?businessId=' + item.businessId\"\n\t\t\t\t\t\tstyle=\"flex: 1; font-size: 32rpx; \">{{ item.businessName }}\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#666\"\n\t\t\t\t\t\t\tstyle=\"position: relative; top: 2rpx;\"></uni-icons>\n\t\t\t\t\t</navigator>\n\t\t\t\t\t<view style=\"font-size: 24rpx; color: #666;\">{{ item.status }}</view>\n\t\t\t\t</view>\n\t\t\t\t<view style=\"display: flex; align-items: center; grid-gap: 20rpx; margin-bottom: 10rpx;\"  @click=\"goOrdersItem(item.id)\">\n\t\t\t\t\t<view>\n\t\t\t\t\t\t<image style=\"display: block; width: 160rpx; height: 160rpx; border-radius: 10rpx;\"\n\t\t\t\t\t\t\t:src=\"item.cover\"></image>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view style=\"flex: 1;\">{{ item.name }}</view>\n\t\t\t\t\t<view>实付￥<text style=\"font-size: 36rpx; font-weight: bold; color: red;\">{{ item.actual }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view style=\"display: flex; min-height: 40rpx;\">\n\t\t\t\t\t<view style=\"flex: 1;\">\n\t\t\t\t\t\t<view v-if=\"item.status === '已取消' || item.status === '已完成' || item.status === '已退款'\"\n\t\t\t\t\t\t\t@click=\"del(item.id)\">\n\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#666\"\n\t\t\t\t\t\t\t\tstyle=\"position: relative; top: 2rpx;\"></uni-icons>\n\t\t\t\t\t\t\t<text style=\"font-size: 24rpx; color: #666;\">删除</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view style=\"flex: 1; text-align: right;\">\n\t\t\t\t\t\t<uni-tag v-if=\"item.status === '待支付'\" text=\"支付\" size=\"mini\" type=\"primary\"\n\t\t\t\t\t\t\t@click=\"changeStatus(item, '待发货')\"></uni-tag>\n\t\t\t\t\t\t<uni-tag v-if=\"item.status === '待发货'\" text=\"申请退款\" size=\"mini\" type=\"error\"\n\t\t\t\t\t\t\t@click=\"changeStatus(item, '已退款')\"></uni-tag>\n\t\t\t\t\t\t<uni-tag v-if=\"item.status === '待收货'\" text=\"确认收货\" size=\"mini\" type=\"warning\"\n\t\t\t\t\t\t\t@click=\"changeStatus(item, '待评价')\"></uni-tag>\n\t\t\t\t\t\t<uni-tag v-if=\"item.status === '待评价'\" text=\"评价\" size=\"mini\" type=\"royal\" @click=\"goComment(item.id)\"></uni-tag>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t    <view v-if=\"imagePopupVisible\" class=\"image-popup\">\n\t\t\t      <image :src=\"imageUrl\" mode=\"widthFix\" class=\"popup-image\"></image>\n\t\t\t      <button class=\"close-btn\" @click=\"closeImagePopup\">关闭</button>\n\t\t\t    </view>\n\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      current: 0,\n      items: ['全部', '进行中', '待评价', '已退款'],\n      ordersList: [],\n      user: uni.getStorageSync('xm-user'),\n      businessQrCodeUrl: '',  // 存储二维码图片URL\n\t     imagePopupVisible:false,  // 控制弹窗显示与隐藏\n\t        imageUrl: '',  // 用于存储图片URL\n    }\n  },\n  onShow() {\n    this.loadOrders();  // 页面展示时加载订单\n  },\n  methods: {\n    goComment(orderId) {\n      uni.navigateTo({\n        url: '/pages/comment/comment?orderId=' + orderId\n      });\n    },\n    goOrdersItem(orderId) {\n      uni.navigateTo({\n        url: '/pages/ordersItem/ordersItem?orderId=' + orderId\n      });\n    },\n    del(orderId) {\n      this.$request.del('/orders/delete/' + orderId).then(res => {\n        if (res.code === '200') {\n          uni.showToast({\n            icon: \"success\",\n            title: '操作成功'\n          });\n          this.loadOrders();\n        } else {\n          uni.showToast({\n            icon: \"error\",\n            title: res.msg\n          });\n        }\n      });\n    },\n    changeStatus(orders, status) {\n      let form = JSON.parse(JSON.stringify(orders));\n      form.status = status;\n      this.$request.put('/orders/update', form).then(res => {\n        if (res.code === '200') {\n          uni.showToast({\n            icon: \"success\",\n            title: '操作成功'\n          });\n          this.loadOrders();\n          this.loadBusinessInfo(orders.businessId);  // 更新商家信息\n        } else {\n          uni.showToast({\n            icon: \"error\",\n            title: res.msg\n          });\n        }\n      });\n    },\n    loadOrders() {\n      let status = '全部';\n      switch (this.current) {\n        case 0:\n          status = '全部';\n          break;\n        case 1:\n          status = '进行中';\n          break;\n        case 2:\n          status = '待评价';\n          break;\n        case 3:\n          status = '已退款';\n          break;\n      }\n      this.$request.get('/orders/selectAll', {\n        userId: this.user.id,\n        status: status\n      }).then(res => {\n        this.ordersList = res.data || [];\n      });\n    },\n    onClickItem(e) {\n      if (this.current != e.currentIndex) {\n        this.current = e.currentIndex;\n        this.loadOrders();\n      }\n    },\n    // 获取商家信息，包括二维码URL\n    loadBusinessInfo(businessId) {\n\t\tconsole.log(businessId);\n      this.$request.get(`/business/selectById/${businessId}`).then(res => {\n        if (res.code === '200') {\n          this.businessQrCodeUrl = res.data.paycode;  // 假设返回的二维码图片 URL 是在 res.data.avatar\n console.log(this.businessQrCodeUrl);\n          // 弹出二维码图片\n          this.showQrCodePopup();\n        } else {\n          uni.showToast({\n            icon: 'error',\n            title: '获取商家二维码失败',\n          });\n        }\n      });\n    },\n\n    // 弹出二维码图片的自定义弹窗         orders\nshowQrCodePopup() {\n      this.imageUrl = this.businessQrCodeUrl;  // 设置图片URL\n\t  console.log(\"s\");\n      this.imagePopupVisible = true;  // 显示弹窗\n    },\n    // 关闭图片弹窗\n    closeImagePopup() {\n      this.imagePopupVisible = false;  // 隐藏弹窗\n    }\n  }\n}\n\n</script>\n<style scoped>\n.image-popup {\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);  /* 半透明背景 */\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  z-index: 9999;\n}\n\n.popup-image {\n  max-width: 90%;\n  max-height: 80%;\n}\n\n.close-btn {\n  position: absolute;\n  bottom: 30rpx;\n  left: 50%;\n  transform: translateX(-50%);\n  padding: 10rpx;\n  background-color: #fff;\n  border-radius: 5rpx;\n  border: none;\n}\n</style>\n","import mod from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orders.vue?vue&type=style&index=0&id=8a71bbb4&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDEA/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orders.vue?vue&type=style&index=0&id=8a71bbb4&scoped=true&lang=css&\""],"sourceRoot":""}